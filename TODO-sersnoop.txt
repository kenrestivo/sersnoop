TODO- serial snooper

try it with sendfile? is it any faster/more responsive?

make the debug code optional? so i can run it as a daemon?
	essentially, make all the display.c shit DPRINTF level 1
		and all the other diagnostics DPRINTF level 2+
	finally, daemonize it.

----------------
STUCK


pollloop is still fucked. 
	seems like poll() returns if an fd closes, but processInput wigs
		STUCK: read the docs, poll, etc. find out what's supposed to happen
		create an exception handling routine that removeFd's etc
	processInput() only does one fd at a time. prolly not good
		not sure about bcast(), if i need to flush readers b4 writing?
			STUCK: read docs

hmm. some way to glean the socket host/port from an fd/sd?
	getpeername
		STUCK:  ack. no good, too slow. i need a global array, dammit.

server mode! oh shit, how to do that?

should i be using O_NDELAY on tty when i'm using select/poll?? good idea?
	STUCK: read up on this

----------------
BELOW THE LINE

cfmakeraw() instead of all that manual flag-setting

	and when in network/daemon mode, connect only when pty opens
		could require significant reshuffling. opens are in main right now... 

	select/poll doesn't work with ptmx's on linux. wtf?
		STUCK: find docs on devpts/ptmx interface on linux, and how it works
				or look in openssh source, for examples

	try termtest on netbsd
		STUCK: need to fix some of the includes/ifdefs/defines

expand to make it handle more than two
	change the command line parsing instead of -a -b, just put them as optind's
		i.e after all the dash options are done!
	either create multi-versions (array?) of the twoxxx functions, or expose them
	fix the polLoop so that it handles a read returning 0 by removing the fd!
		perhaps it needs to remvoe the OPPOSITE side's fd? why is this broken?

create a DIEUSAGE macro?

----------------
NOWHERE

	wow! if the cable is present, i get an 0x07 back... is that predictable?
		NO. could be a good way to tell what's going on!

	test with standard terminal shit
		btw read telnet rfc's
		NOWHERE: need server shit: 
deal with the writing now.
	shall i select for write? hmm... could get tricky...
		NOWHERE: not needed, i don't think
	try it on netbsd? NOWHERE: same problem
	try the oldskool berkeley shit instead?
		it fixes the crash at basic read
		ack. that's borken too
	re-read unix book on terminals NOTHING there on ptmx?
	try putting signal handlers in NOWHERE. still broken
----------------
DONE

		ack! /usr/include/asm/ioctls.h. uses TIOCGPTN not TIOCGNAME i.e. SYSV
set up and open tty
	lift from chotplay/src/tty.c
		DONE
set up and open pty
	lift from termtest
	use only the linux version, for now anyway.
		DONE

write a simple poll/select loop to read from both/either
	there's one in sockclient/server isn't there? DONE

	try select instead
		SOLUTION! it works!
try poll...again... with & not ==
	SOLUTION: that was it! i just copied the select code, changed to poll, all's good

ack. the poll is broken. but raw reads work just fine.
	look at openssh?
		SOLUTION: just looked in orielly book. simple change

baud setting looks alllll goooodd
		ack, garbage chars, or something wrong. readcount is too long!
			SOLUTION: it includes cr/lf, AND it's not null-terminated. duh.
	get %*s going or snprintf or something
		SOLUTION: done
	do some isprint() shit. DONE
		hmm. some constipation. my while() read loop?
			SOLUTION: no while
hmm. shall i read until done, or just grab one chunk?
	look around at other code
		SOLUTION: nope. no while, just an if

start the writing/reading. 
	make sure it works, and works well.
		well, it does, dammit!
	some static var, who was talking last, so if it changes, i print that?
		cool. but... the totals don't look quite yet
			SOLUTION: sequence is important ;-)
add in the decoding/printing
	lift from xxd? ;-) at least read it
		DONE. it's not perfect, or even nice, but it works
figure out the command-line options
		two devices: a and b
			each device could be one of net/pty/tty
		ok, -a and -b. spec it as /dev/xxx:baud or host.name.domain:port
			grab code from chotplay DONE
	roll in the code (should be easy) DONE
	
	parse out the device line DONE
	regression testing DONE. 'tworks
	some way to keep track of hup's, pts's open/closed, tty's open/closed
		i.e at least print an informative message
			DONE! READ 0 if socket closed
that weird network read = 0 shit?
	can i exit if i get a read of 0? DONE
	why it dooo dat? socket closed? term server hung up?
		SOLUTION: assume so.

	test with bogus/safe terminal SERVER DONE. it works
ok, go for it: add in the network code! now i have something like net2tty
	test with the actual camera! this be it... 
		hmm. weirdness.  SEP: chotplay
		HAH! well, with two chotplays in serial, it works JUST FINE!
